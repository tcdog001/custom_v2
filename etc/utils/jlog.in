#!/bin/bash

if [[ -z "${__UTILS_JLOG_IN__}" ]]; then __UTILS_JLOG_IN__=_; else return; fi

. ${__ROOTFS__}/etc/utils/json.in

readonly -A JLOGGER_PRI=(
	[emerg]=0
	[alert]=1
	[crit]=2
	[error]=3
	[waring]=4
	[notice]=5
	[info]=6
	[debug]=7
)

#
#$1:app
#$2:pri
#$3:kvs...
#
jlog_kvs() {
	local app="$1"
	local pri="$2"; shift 2
	local json=$(json_create_bykvs "$@")

	jlogger "${app}" "${JLOGGER_PRI[${pri}]}" "${json}"
}

#
#$1:app
#$2:pri
#$3:key
#$4:json...
#
jlog_ko() {
	local app="$1"
	local pri="$2"; shift 2
	local json=$(__json_create_byko "$@")

	jlogger "${app}" "${JLOGGER_PRI[${pri}]}" "${json}"
}
